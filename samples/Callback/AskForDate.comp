<?xml version="1.0" encoding="utf-8"?>
<File>
  <Version>2.1</Version>
  <Variables>
    <ArrayOfVariable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <Variable>
        <Name>HasToAskDate</Name>
        <InitialValue>true</InitialValue>
        <Scope>Private</Scope>
        <ShowScopeProperty>true</ShowScopeProperty>
        <DebuggerVisible>true</DebuggerVisible>
        <HelpText />
      </Variable>
      <Variable>
        <Name>Out_SelectedDate</Name>
        <ShowScopeProperty>true</ShowScopeProperty>
        <DebuggerVisible>true</DebuggerVisible>
        <HelpText />
      </Variable>
    </ArrayOfVariable>
  </Variables>
  <Flows>
    <MainFlow>
      <ns0:MainFlow Description="Callflow execution path." DebugModeActive="False" x:Name="AskForDate" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:ns0="clr-namespace:TCX.CFD.Classes.Components;Assembly=3CX Call Flow Designer, Version=18.0.48.0, Culture=neutral, PublicKeyToken=7cb95a1a133e706e">
        <ns0:LoopComponent Condition="callflow$.HasToAskDate" Description="Execution path when the specified condition is met." Tag="" DebugModeActive="False" x:Name="AskDateLoop">
          <ns0:VoiceInputComponent AcceptDtmfInput="False" StopDigit="None" IsValidDigit_3="False" IsValidDigit_0="False" IsValidDigit_1="False" IsValidDigit_Pound="False" IsValidDigit_7="False" IsValidDigit_4="False" IsValidDigit_5="False" SubsequentPromptList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfPrompt xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;Prompt xsi:type=&quot;TextToSpeechAudioPrompt&quot;&gt;&lt;VoiceName&gt;en-US-Standard-C&lt;/VoiceName&gt;&lt;VoiceType&gt;Standard&lt;/VoiceType&gt;&lt;Format&gt;Text&lt;/Format&gt;&lt;Text&gt;&quot;Please, say for what date you want to schedule the callback.&quot;&lt;/Text&gt;&lt;/Prompt&gt;&lt;/ArrayOfPrompt&gt;" IsValidDigit_2="False" IsValidDigit_6="False" InputTimeout="3" Dictionary="" MinDigits="3" InitialPromptList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfPrompt xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;Prompt xsi:type=&quot;TextToSpeechAudioPrompt&quot;&gt;&lt;VoiceName&gt;en-US-Standard-C&lt;/VoiceName&gt;&lt;VoiceType&gt;Standard&lt;/VoiceType&gt;&lt;Format&gt;Text&lt;/Format&gt;&lt;Text&gt;&quot;Please, say for what date you want to schedule the callback.&quot;&lt;/Text&gt;&lt;/Prompt&gt;&lt;/ArrayOfPrompt&gt;" LanguageCode="en-US" DtmfTimeout="3" MaxRetryCount="3" DebugModeActive="False" MaxDigits="6" Tag="" IsValidDigit_8="False" Hints="$MONTH $DAY, $DAY of $MONTH, today, tomorrow" InvalidInputPromptList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfPrompt xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;Prompt xsi:type=&quot;TextToSpeechAudioPrompt&quot;&gt;&lt;VoiceName&gt;en-US-Standard-C&lt;/VoiceName&gt;&lt;VoiceType&gt;Standard&lt;/VoiceType&gt;&lt;Format&gt;Text&lt;/Format&gt;&lt;Text&gt;&quot;Sorry, we couldn't understand what you said.&quot;&lt;/Text&gt;&lt;/Prompt&gt;&lt;/ArrayOfPrompt&gt;" IsValidDigit_Star="False" TimeoutPromptList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfPrompt xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;Prompt xsi:type=&quot;TextToSpeechAudioPrompt&quot;&gt;&lt;VoiceName&gt;en-US-Standard-C&lt;/VoiceName&gt;&lt;VoiceType&gt;Standard&lt;/VoiceType&gt;&lt;Format&gt;Text&lt;/Format&gt;&lt;Text&gt;&quot;Sorry, we couldn't hear you.&quot;&lt;/Text&gt;&lt;/Prompt&gt;&lt;/ArrayOfPrompt&gt;" IsValidDigit_9="False" x:Name="RequestDate">
            <ns0:ComponentBranch DisplayedText="Valid Input" Description="Execution path when the specified branch is activated." Tag="" DebugModeActive="False" x:Name="componentBranch1">
              <ns0:ExecuteCSharpCodeComponent ReturnsValue="True" Code="string inputLowerCase = input.ToLower();&#xD;&#xA;if (inputLowerCase.Contains(&quot;today&quot;) || inputLowerCase.Contains(&quot;tomorrow&quot;))&#xD;&#xA;    return true;&#xD;&#xA;&#xD;&#xA;string[] validformats = new[] &#xD;&#xA;{ &#xD;&#xA;    &quot;MMMM d&quot;,&#xD;&#xA;    &quot;MMMM d\\s\\t&quot;,&#xD;&#xA;    &quot;MMMM dn\\d&quot;,&#xD;&#xA;    &quot;MMMM dr\\d&quot;,&#xD;&#xA;    &quot;MMMM d\\t\\h&quot;,&#xD;&#xA;    &quot;d o\\f MMMM&quot;,&#xD;&#xA;    &quot;d\\s\\t o\\f MMMM&quot;,&#xD;&#xA;    &quot;dn\\d o\\f MMMM&quot;,&#xD;&#xA;    &quot;dr\\d o\\f MMMM&quot;,&#xD;&#xA;    &quot;d\\t\\h o\\f MMMM&quot;&#xD;&#xA;};&#xD;&#xA;return DateTime.TryParseExact(inputLowerCase, validformats, System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out _);&#xD;&#xA;" ParameterList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfScriptParameter xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;ScriptParameter&gt;&lt;Name&gt;input&lt;/Name&gt;&lt;Value&gt;RequestDate.RecognizedText&lt;/Value&gt;&lt;Type&gt;String&lt;/Type&gt;&lt;/ScriptParameter&gt;&lt;/ArrayOfScriptParameter&gt;" MethodName="IsValidDate" Tag="" DebugModeActive="False" x:Name="IsValidDate" />
              <ns0:ConditionalComponent Tag="" DebugModeActive="False" x:Name="CheckValidDate">
                <ns0:ConditionalComponentBranch Condition="IsValidDate.ReturnValue" Description="Execution path when the specified condition is met." Tag="" DebugModeActive="False" x:Name="ValidDate">
                  <ns0:ExecuteCSharpCodeComponent ReturnsValue="True" Code="DateTime nowDt = DateTime.Now;&#xD;&#xA;DateTime todayDt = new DateTime(nowDt.Year, nowDt.Month, nowDt.Day, 0, 0, 0);&#xD;&#xA;&#xD;&#xA;string inputLowerCase = input.ToLower();&#xD;&#xA;if (inputLowerCase.Contains(&quot;today&quot;)) return todayDt;&#xD;&#xA;&#xD;&#xA;if (inputLowerCase.Contains(&quot;tomorrow&quot;)) return todayDt.AddDays(1);&#xD;&#xA;&#xD;&#xA;string[] validformats = new[] &#xD;&#xA;{ &#xD;&#xA;    &quot;MMMM d&quot;,&#xD;&#xA;    &quot;MMMM d\\s\\t&quot;,&#xD;&#xA;    &quot;MMMM dn\\d&quot;,&#xD;&#xA;    &quot;MMMM dr\\d&quot;,&#xD;&#xA;    &quot;MMMM d\\t\\h&quot;,&#xD;&#xA;    &quot;d o\\f MMMM&quot;,&#xD;&#xA;    &quot;d\\s\\t o\\f MMMM&quot;,&#xD;&#xA;    &quot;dn\\d o\\f MMMM&quot;,&#xD;&#xA;    &quot;dr\\d o\\f MMMM&quot;,&#xD;&#xA;    &quot;d\\t\\h o\\f MMMM&quot;&#xD;&#xA;};&#xD;&#xA;DateTime dt = DateTime.ParseExact(inputLowerCase, validformats, System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None);&#xD;&#xA;return dt &lt; todayDt ? dt.AddYears(1) : dt;&#xD;&#xA;" ParameterList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfScriptParameter xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;ScriptParameter&gt;&lt;Name&gt;input&lt;/Name&gt;&lt;Value&gt;RequestDate.RecognizedText&lt;/Value&gt;&lt;Type&gt;String&lt;/Type&gt;&lt;/ScriptParameter&gt;&lt;/ArrayOfScriptParameter&gt;" MethodName="ConvertToDate" Tag="" DebugModeActive="False" x:Name="ConvertToDate" />
                  <ns0:VariableAssignmentComponent VariableName="callflow$.Out_SelectedDate" Tag="" DebugModeActive="False" Expression="ConvertToDate.ReturnValue" x:Name="SetDate" />
                  <ns0:ExecuteCSharpCodeComponent ReturnsValue="True" Code="return ((DateTime)datetime).ToString(&quot;MMMM d, yyyy&quot;);" ParameterList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfScriptParameter xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;ScriptParameter&gt;&lt;Name&gt;datetime&lt;/Name&gt;&lt;Value&gt;callflow$.Out_SelectedDate&lt;/Value&gt;&lt;Type&gt;Object&lt;/Type&gt;&lt;/ScriptParameter&gt;&lt;/ArrayOfScriptParameter&gt;" MethodName="ConvertDateToString" Tag="" DebugModeActive="False" x:Name="ConvertDateToString" />
                  <ns0:PromptPlaybackComponent Tag="" AcceptDtmfInput="False" DebugModeActive="False" PromptList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfPrompt xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;Prompt xsi:type=&quot;TextToSpeechAudioPrompt&quot;&gt;&lt;VoiceName&gt;en-US-Standard-C&lt;/VoiceName&gt;&lt;VoiceType&gt;Standard&lt;/VoiceType&gt;&lt;Format&gt;Text&lt;/Format&gt;&lt;Text&gt;CONCATENATE(&quot;We will schedule your callback on &quot;,ConvertDateToString.ReturnValue)&lt;/Text&gt;&lt;/Prompt&gt;&lt;/ArrayOfPrompt&gt;" x:Name="PlayDate" />
                  <ns0:VariableAssignmentComponent VariableName="callflow$.HasToAskDate" Tag="" DebugModeActive="False" Expression="false" x:Name="ExitAskDateLoop" />
                </ns0:ConditionalComponentBranch>
                <ns0:ConditionalComponentBranch Condition="" Description="Execution path when the specified condition is met." Tag="" DebugModeActive="False" x:Name="InvalidDate">
                  <ns0:PromptPlaybackComponent Tag="" AcceptDtmfInput="True" DebugModeActive="False" PromptList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfPrompt xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;Prompt xsi:type=&quot;TextToSpeechAudioPrompt&quot;&gt;&lt;VoiceName&gt;en-US-Standard-C&lt;/VoiceName&gt;&lt;VoiceType&gt;Standard&lt;/VoiceType&gt;&lt;Format&gt;Text&lt;/Format&gt;&lt;Text&gt;&quot;Sorry, we couldn't understand the date you said. Please try again.&quot;&lt;/Text&gt;&lt;/Prompt&gt;&lt;/ArrayOfPrompt&gt;" x:Name="PlayInvalidDate" />
                </ns0:ConditionalComponentBranch>
              </ns0:ConditionalComponent>
            </ns0:ComponentBranch>
            <ns0:ComponentBranch DisplayedText="Invalid Input" Description="Execution path when the specified branch is activated." Tag="" DebugModeActive="False" x:Name="componentBranch2">
              <ns0:PromptPlaybackComponent Tag="" AcceptDtmfInput="True" DebugModeActive="False" PromptList="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;&lt;ArrayOfPrompt xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;Prompt xsi:type=&quot;TextToSpeechAudioPrompt&quot;&gt;&lt;VoiceName&gt;en-US-Standard-C&lt;/VoiceName&gt;&lt;VoiceType&gt;Standard&lt;/VoiceType&gt;&lt;Format&gt;Text&lt;/Format&gt;&lt;Text&gt;&quot;Sorry, we couldn't schedule the callback, please call again later.&quot;&lt;/Text&gt;&lt;/Prompt&gt;&lt;/ArrayOfPrompt&gt;" x:Name="SorryTryLater" />
              <ns0:DisconnectCallComponent Tag="" DebugModeActive="False" x:Name="DisconnectCallOnError" />
            </ns0:ComponentBranch>
          </ns0:VoiceInputComponent>
        </ns0:LoopComponent>
      </ns0:MainFlow>
    </MainFlow>
    <ErrorHandlerFlow>
      <ns0:ErrorHandlerFlow Description="Execution path when an error ocurrs." DebugModeActive="False" x:Name="AskForDate" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:ns0="clr-namespace:TCX.CFD.Classes.Components;Assembly=3CX Call Flow Designer, Version=18.0.48.0, Culture=neutral, PublicKeyToken=7cb95a1a133e706e" />
    </ErrorHandlerFlow>
    <DisconnectHandlerFlow>
      <ns0:DisconnectHandlerFlow Description="Execution path since the call gets disconnected." DebugModeActive="False" x:Name="AskForDate" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:ns0="clr-namespace:TCX.CFD.Classes.Components;Assembly=3CX Call Flow Designer, Version=18.0.48.0, Culture=neutral, PublicKeyToken=7cb95a1a133e706e" />
    </DisconnectHandlerFlow>
  </Flows>
</File>